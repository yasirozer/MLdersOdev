from sklearn.model_selection import train_test_split
from sklearn.neighbors import KNeighborsClassifier
import pandas as pd


def main():
    # Load data from ODS files
    x_df = pd.read_excel("bas-kilo.ods", engine="odf")
    y_df = pd.read_excel("cinsiyet.ods", engine="odf")

    # Features and labels
    x = x_df[["Bascevre", "Kilo"]]
    y = y_df["Cinsiyet"]

    if len(x) != len(y):
        raise ValueError(
            f"Feature and label row counts do not match: {len(x)} != {len(y)}"
        )

    # Train/test split
    x_train, x_test, y_train, y_test = train_test_split(
        x, y, test_size=0.2, random_state=42
    )

    # Train model
    knn = KNeighborsClassifier(n_neighbors=5)
    knn.fit(x_train, y_train)

    # Evaluate
    accuracy = knn.score(x_test, y_test)
    print(f"Accuracy: {accuracy:.4f}")

    # Example prediction: [Bascevre, Kilo]
    sample = pd.DataFrame([{"Bascevre": 56, "Kilo": 75}])
    prediction = knn.predict(sample)[0]
    print(f"Sample prediction for {sample.iloc[0].to_dict()}: {prediction}")


if __name__ == "__main__":
    main()
